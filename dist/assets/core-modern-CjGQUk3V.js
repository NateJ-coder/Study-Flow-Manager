(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function o(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerPolicy&&(r.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?r.credentials="include":n.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(n){if(n.ep)return;n.ep=!0;const r=o(n);fetch(n.href,r)}})();console.log("[animation-frame.js] Module loaded ‚úÖ");function f(){const t=document.getElementById("app-title");t&&(console.log("[animation-frame] Starting swirl animation"),t.style.opacity=0,t.style.transform="rotate(-180deg) scale(0.5)",t.style.transition="transform 1.2s ease-out, opacity 1.2s ease-out",requestAnimationFrame(()=>{setTimeout(()=>{t.style.opacity=1,t.style.transform="rotate(0deg) scale(1)"},200)}))}function g(){console.log("[animation-frame] Launching wind trails");const t=document.body;document.querySelectorAll(".wind-trail").forEach(o=>o.remove());for(let o=0;o<6;o++){const s=document.createElement("div");s.className="wind-trail",s.style.left=`${Math.random()*100}vw`,s.style.top=`${Math.random()*60+10}vh`,s.style.animationDelay=`${o*.5}s`,t.appendChild(s),setTimeout(()=>{s.parentNode&&s.remove()},4e3+o*500)}}function y(){console.log("[animation-frame] Enabling frame animations");const t=document.getElementById("studyframe");t&&t.classList.remove("paused")}console.log("[timer-module.js] Module loaded ‚úÖ");function p(){console.log("‚öôÔ∏è Initializing timer button handlers");const t=document.getElementById("btn-start"),e=document.getElementById("btn-reset");if(!t||!e){console.warn("[timer-module.js] Timer buttons not found ‚ùå");return}t.dataset.bound||(t.addEventListener("click",()=>{window.startTimer?window.startTimer():console.log("‚è± Timer started (module fallback)")}),t.dataset.bound="1"),e.dataset.bound||(e.addEventListener("click",()=>{window.resetTimer?window.resetTimer():console.log("üîÅ Timer reset (module fallback)")}),e.dataset.bound="1"),console.log("[timer-module.js] Timer buttons initialized ‚úÖ")}function h(){console.log("üé® Enhancing timer display");const t=document.querySelector(".timer-ui");t&&(t.style.transition="all 0.3s ease")}console.log("[settings.js] Module loaded ‚úÖ");const c=1,b=1e4;function w(){console.log("‚öôÔ∏è Settings loaded with security validation");const t={version:c,calendar_cross_color:"#ff4d4d",background_brightness:100,frame_opacity:100,season:"summer",timezone:"Africa/Johannesburg",slideshow_enabled:!0,slideshow_interval_seconds:30,pomodoro_sessions:4,work_minutes:25,short_break_minutes:5,long_break_minutes:20,short_breaks_before_long:3,rain_toggle_enabled:!1};try{const e=localStorage.getItem("studyflow_settings");if(!e)return t;if(e.length>b)return console.warn("[settings] Settings too large, using defaults"),t;const o=JSON.parse(e);if(o.version!==c)return console.warn(`[settings] Version mismatch (got ${o.version}, expected ${c}), using defaults`),t;const s=new Set(Object.keys(t)),n={};return Object.entries(o).forEach(([r,i])=>{s.has(r)&&(n[r]=i)}),{...t,...n}}catch(e){return console.warn("[settings] Error loading settings:",e),localStorage.removeItem("studyflow_settings"),t}}const S=new Set(["summer","autumn","winter","rain"]);function a(t,e=0,o=100,s=100){const n=Number(t);return isNaN(n)?s:Math.max(e,Math.min(o,n))}function _(t){console.log("[settings] Applying theme settings with security validation");const e={...t};S.has(e.season)||(console.warn(`[settings] Invalid season "${e.season}", defaulting to summer`),e.season="summer"),e.background_brightness=a(e.background_brightness,0,100,100),e.frame_opacity=a(e.frame_opacity,0,100,100),e.pomodoro_sessions=a(e.pomodoro_sessions,1,10,4),e.work_minutes=a(e.work_minutes,1,120,25),e.short_break_minutes=a(e.short_break_minutes,1,60,5),e.long_break_minutes=a(e.long_break_minutes,1,120,20),e.slideshow_interval_seconds=a(e.slideshow_interval_seconds,5,300,30);const o=document.getElementById("bg-root");o&&(o.style.opacity=e.background_brightness/100);const s=document.querySelector(".frame-ornate");return s&&(s.style.opacity=e.frame_opacity/100),document.body.setAttribute("data-theme",e.season),e}console.log("[svg-utils.js] SVG security utilities loaded ‚úÖ");function m(t,e){try{const o=new DOMParser().parseFromString(e,"image/svg+xml");if(o.querySelectorAll("script").forEach(n=>n.remove()),o.querySelectorAll("*").forEach(n=>{[...n.attributes].forEach(r=>{r.name.startsWith("on")&&n.removeAttribute(r.name),(r.name==="href"||r.name==="xlink:href")&&n.removeAttribute(r.name)})}),o.querySelector("parsererror"))throw new Error("Invalid SVG content");t.replaceChildren(o.documentElement),console.log("[svg-utils] SVG safely inserted after sanitization")}catch(o){console.error("[svg-utils] Error sanitizing SVG:",o),t.innerHTML="<span>‚ö†Ô∏è</span>"}}function u(t,e="summer"){const o={summer:{primary:"#4ECDC4",secondary:"#45B7D1"},autumn:{primary:"#FF6B35",secondary:"#F7931E"},winter:{primary:"#74B9FF",secondary:"#0984E3"},rain:{primary:"#636E72",secondary:"#2D3436"}},s=o[e]||o.summer;return t.replace(/#THEME_PRIMARY/g,s.primary).replace(/#THEME_SECONDARY/g,s.secondary)}console.log("[core-modern.js] StudyFlow modern modules loading üåÄ");document.addEventListener("DOMContentLoaded",()=>{console.log("[core-modern.js] DOM loaded, applying modern enhancements"),setTimeout(()=>{E()},100)});async function E(){try{console.log("[core-modern.js] Initializing modern features");const t=w();_(t),p(),h(),await T(t),f(),y(),v(),window.matchMedia("(prefers-reduced-motion: reduce)").matches||setTimeout(()=>{g()},800),console.log("[core-modern.js] All modern features initialized ‚úÖ")}catch(t){console.error("[core-modern.js] Error initializing modern features:",t)}}function v(){const t=document.getElementById("app-title");if(!t)return;const e=["","style-bounce","style-glow"];let o=0;setInterval(()=>{e.forEach(s=>{s&&t.classList.remove(s)}),o=(o+1)%e.length,e[o]&&t.classList.add(e[o])},8e3),t.addEventListener("click",()=>{e.forEach(s=>{s&&t.classList.remove(s)}),o=(o+1)%e.length,e[o]&&t.classList.add(e[o])}),t.style.cursor="pointer",t.title="Click to change animation style"}async function T(t){try{const e=t?.season||"summer",o=await fetch("assets/images/start-button.svg");if(!o.ok)throw new Error(`Failed to load start button: ${o.status}`);const s=await o.text(),n=document.getElementById("btn-start");if(n){const l=u(s,e);m(n,l)}const r=await fetch("assets/images/reset-button.svg");if(!r.ok)throw new Error(`Failed to load reset button: ${r.status}`);const i=await r.text(),d=document.getElementById("btn-reset");if(d){const l=u(i,e);m(d,l)}console.log("[core-modern.js] SVG buttons safely loaded and themed")}catch(e){console.warn("[core-modern.js] Could not load SVG buttons:",e);const o=document.getElementById("btn-start"),s=document.getElementById("btn-reset");if(o){const n=o.querySelector(".button-text");n&&(n.style.display="block",n.style.fontSize="clamp(12px, 1.5vw, 16px)")}if(s){const n=s.querySelector(".button-text");n&&(n.style.display="block",n.style.fontSize="clamp(12px, 1.5vw, 16px)")}console.log("[core-modern.js] Using text fallback for buttons")}}
//# sourceMappingURL=core-modern-CjGQUk3V.js.map
