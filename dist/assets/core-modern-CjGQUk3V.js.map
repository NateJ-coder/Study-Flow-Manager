{"version":3,"file":"core-modern-CjGQUk3V.js","sources":["../../js/animation-frame.js","../../js/timer-module.js","../../js/settings.js","../../js/svg-utils.js","../../js/core-modern.js"],"sourcesContent":["// animation-frame.js — intro and frame animations\r\nconsole.log(\"[animation-frame.js] Module loaded ✅\");\r\n\r\nexport function swirlInTitle() {\r\n  const title = document.getElementById(\"app-title\");\r\n  if (!title) return;\r\n  console.log(\"[animation-frame] Starting swirl animation\");\r\n\r\n  title.style.opacity = 0;\r\n  title.style.transform = \"rotate(-180deg) scale(0.5)\";\r\n  title.style.transition = \"transform 1.2s ease-out, opacity 1.2s ease-out\";\r\n\r\n  requestAnimationFrame(() => {\r\n    setTimeout(() => {\r\n      title.style.opacity = 1;\r\n      title.style.transform = \"rotate(0deg) scale(1)\";\r\n    }, 200);\r\n  });\r\n}\r\n\r\nexport function startWindTrails() {\r\n  console.log(\"[animation-frame] Launching wind trails\");\r\n  const container = document.body;\r\n  \r\n  // Remove any existing wind trails first\r\n  const existingTrails = document.querySelectorAll('.wind-trail');\r\n  existingTrails.forEach(trail => trail.remove());\r\n  \r\n  for (let i = 0; i < 6; i++) {\r\n    const trail = document.createElement(\"div\");\r\n    trail.className = \"wind-trail\";\r\n    trail.style.left = `${Math.random() * 100}vw`;\r\n    trail.style.top = `${Math.random() * 60 + 10}vh`;\r\n    trail.style.animationDelay = `${i * 0.5}s`;\r\n    container.appendChild(trail);\r\n    \r\n    // Remove trail after animation completes\r\n    setTimeout(() => {\r\n      if (trail.parentNode) {\r\n        trail.remove();\r\n      }\r\n    }, 4000 + (i * 500));\r\n  }\r\n}\r\n\r\nexport function enableFrameAnimations() {\r\n  console.log(\"[animation-frame] Enabling frame animations\");\r\n  const frame = document.getElementById(\"studyframe\");\r\n  if (frame) {\r\n    frame.classList.remove(\"paused\");\r\n  }\r\n}\r\n\r\nexport function pauseFrameAnimations() {\r\n  console.log(\"[animation-frame] Pausing frame animations\");\r\n  const frame = document.getElementById(\"studyframe\");\r\n  if (frame) {\r\n    frame.classList.add(\"paused\");\r\n  }\r\n}\r\n","// timer-module.js — modular timer functions that work with existing core.js\r\nconsole.log(\"[timer-module.js] Module loaded ✅\");\r\n\r\n// These functions will work alongside the existing timer functions in core.js\r\nexport function initializeTimerButtons() {\r\n  console.log(\"⚙️ Initializing timer button handlers\");\r\n  \r\n  const startBtn = document.getElementById(\"btn-start\");\r\n  const resetBtn = document.getElementById(\"btn-reset\");\r\n\r\n  if (!startBtn || !resetBtn) {\r\n    console.warn(\"[timer-module.js] Timer buttons not found ❌\");\r\n    return;\r\n  }\r\n\r\n  // Idempotent guards: prevent double event listener binding\r\n  if (!startBtn.dataset.bound) {\r\n    startBtn.addEventListener(\"click\", () => {\r\n      if (window.startTimer) {\r\n        window.startTimer();\r\n      } else {\r\n        console.log(\"⏱ Timer started (module fallback)\");\r\n      }\r\n    });\r\n    startBtn.dataset.bound = '1';\r\n  }\r\n  \r\n  if (!resetBtn.dataset.bound) {\r\n    resetBtn.addEventListener(\"click\", () => {\r\n      if (window.resetTimer) {\r\n        window.resetTimer();\r\n      } else {\r\n        console.log(\"🔁 Timer reset (module fallback)\");\r\n      }\r\n    });\r\n    resetBtn.dataset.bound = '1';\r\n  }\r\n  \r\n  console.log(\"[timer-module.js] Timer buttons initialized ✅\");\r\n}\r\n\r\nexport function enhanceTimerDisplay() {\r\n  console.log(\"🎨 Enhancing timer display\");\r\n  \r\n  // Add visual enhancements to the timer\r\n  const timerUI = document.querySelector('.timer-ui');\r\n  if (timerUI) {\r\n    timerUI.style.transition = 'all 0.3s ease';\r\n  }\r\n}","// settings.js — handles user preferences, themes, and form interactions\r\nconsole.log(\"[settings.js] Module loaded ✅\");\r\n\r\nconst SETTINGS_VERSION = 1;\r\nconst MAX_SETTINGS_SIZE = 10000; // 10KB limit for localStorage\r\n\r\nexport function loadSettings() {\r\n  console.log(\"⚙️ Settings loaded with security validation\");\r\n  \r\n  // Secure defaults with validation\r\n  const defaults = {\r\n    version: SETTINGS_VERSION,\r\n    calendar_cross_color: \"#ff4d4d\",\r\n    background_brightness: 100,\r\n    frame_opacity: 100,\r\n    season: \"summer\",\r\n    timezone: \"Africa/Johannesburg\",\r\n    slideshow_enabled: true,\r\n    slideshow_interval_seconds: 30,\r\n    pomodoro_sessions: 4,\r\n    work_minutes: 25,\r\n    short_break_minutes: 5,\r\n    long_break_minutes: 20,\r\n    short_breaks_before_long: 3,\r\n    rain_toggle_enabled: false\r\n  };\r\n\r\n  try {\r\n    const saved = localStorage.getItem('studyflow_settings');\r\n    if (!saved) return defaults;\r\n    \r\n    // Size check for security\r\n    if (saved.length > MAX_SETTINGS_SIZE) {\r\n      console.warn(\"[settings] Settings too large, using defaults\");\r\n      return defaults;\r\n    }\r\n    \r\n    const parsed = JSON.parse(saved);\r\n    \r\n    // Version check for migration safety\r\n    if (parsed.version !== SETTINGS_VERSION) {\r\n      console.warn(`[settings] Version mismatch (got ${parsed.version}, expected ${SETTINGS_VERSION}), using defaults`);\r\n      return defaults;\r\n    }\r\n    \r\n    // Schema validation: only allow known keys\r\n    const validKeys = new Set(Object.keys(defaults));\r\n    const filtered = {};\r\n    Object.entries(parsed).forEach(([key, value]) => {\r\n      if (validKeys.has(key)) {\r\n        filtered[key] = value;\r\n      }\r\n    });\r\n    \r\n    return { ...defaults, ...filtered };\r\n  } catch (error) {\r\n    console.warn(\"[settings] Error loading settings:\", error);\r\n    localStorage.removeItem('studyflow_settings'); // Clear corrupted data\r\n    return defaults;\r\n  }\r\n}\r\n\r\nexport function saveSettings(settings) {\r\n  console.log(\"💾 Settings saved with security validation\");\r\n  \r\n  try {\r\n    // Ensure version is set\r\n    const versioned = { ...settings, version: SETTINGS_VERSION };\r\n    \r\n    // Serialize and check size\r\n    const serialized = JSON.stringify(versioned);\r\n    if (serialized.length > MAX_SETTINGS_SIZE) {\r\n      console.error(\"[settings] Settings payload too large, not saving\");\r\n      return false;\r\n    }\r\n    \r\n    localStorage.setItem('studyflow_settings', serialized);\r\n    return true;\r\n  } catch (error) {\r\n    console.error(\"[settings] Error saving settings:\", error);\r\n    return false;\r\n  }\r\n}\r\n\r\n// Security: Whitelist allowed values\r\nconst ALLOWED_SEASONS = new Set(['summer', 'autumn', 'winter', 'rain']);\r\nconst ALLOWED_TIMEZONES = new Set(['Africa/Johannesburg']); // Expand as needed\r\n\r\n// Utility: Clamp numeric values to safe ranges\r\nfunction clampValue(value, min = 0, max = 100, fallback = 100) {\r\n  const num = Number(value);\r\n  if (isNaN(num)) return fallback;\r\n  return Math.max(min, Math.min(max, num));\r\n}\r\n\r\nexport function applyThemeSettings(settings) {\r\n  console.log(\"[settings] Applying theme settings with security validation\");\r\n  \r\n  // Create sanitized copy of settings\r\n  const sanitized = { ...settings };\r\n  \r\n  // Validate and sanitize season\r\n  if (!ALLOWED_SEASONS.has(sanitized.season)) {\r\n    console.warn(`[settings] Invalid season \"${sanitized.season}\", defaulting to summer`);\r\n    sanitized.season = 'summer';\r\n  }\r\n  \r\n  // Validate and clamp numeric values\r\n  sanitized.background_brightness = clampValue(sanitized.background_brightness, 0, 100, 100);\r\n  sanitized.frame_opacity = clampValue(sanitized.frame_opacity, 0, 100, 100);\r\n  sanitized.pomodoro_sessions = clampValue(sanitized.pomodoro_sessions, 1, 10, 4);\r\n  sanitized.work_minutes = clampValue(sanitized.work_minutes, 1, 120, 25);\r\n  sanitized.short_break_minutes = clampValue(sanitized.short_break_minutes, 1, 60, 5);\r\n  sanitized.long_break_minutes = clampValue(sanitized.long_break_minutes, 1, 120, 20);\r\n  sanitized.slideshow_interval_seconds = clampValue(sanitized.slideshow_interval_seconds, 5, 300, 30);\r\n  \r\n  // Apply background brightness (safely clamped)\r\n  const bgRoot = document.getElementById('bg-root');\r\n  if (bgRoot) {\r\n    bgRoot.style.opacity = sanitized.background_brightness / 100;\r\n  }\r\n  \r\n  // Apply frame opacity (safely clamped)\r\n  const frame = document.querySelector('.frame-ornate');\r\n  if (frame) {\r\n    frame.style.opacity = sanitized.frame_opacity / 100;\r\n  }\r\n  \r\n  // Apply season (whitelisted)\r\n  document.body.setAttribute('data-theme', sanitized.season);\r\n  \r\n  return sanitized; // Return sanitized settings for further use\r\n}\r\n","// svg-utils.js — Safe SVG handling utilities\r\nconsole.log(\"[svg-utils.js] SVG security utilities loaded ✅\");\r\n\r\n/**\r\n * Safely insert SVG content by removing potential XSS vectors\r\n * @param {HTMLElement} targetEl - Element to insert SVG into\r\n * @param {string} svgText - SVG content to sanitize and insert\r\n */\r\nexport function safeInsertSVG(targetEl, svgText) {\r\n  try {\r\n    const doc = new DOMParser().parseFromString(svgText, 'image/svg+xml');\r\n    \r\n    // Security: Remove any <script> tags\r\n    doc.querySelectorAll('script').forEach(n => n.remove());\r\n    \r\n    // Security: Remove all event handler attributes and dangerous links\r\n    doc.querySelectorAll('*').forEach(n => {\r\n      [...n.attributes].forEach(a => {\r\n        if (a.name.startsWith('on')) {\r\n          n.removeAttribute(a.name);\r\n        }\r\n        if (a.name === 'href' || a.name === 'xlink:href') {\r\n          n.removeAttribute(a.name);\r\n        }\r\n      });\r\n    });\r\n    \r\n    // Check for parser errors\r\n    const errorNode = doc.querySelector('parsererror');\r\n    if (errorNode) {\r\n      throw new Error('Invalid SVG content');\r\n    }\r\n    \r\n    // Safe insertion using replaceChildren instead of innerHTML\r\n    targetEl.replaceChildren(doc.documentElement);\r\n    \r\n    console.log(\"[svg-utils] SVG safely inserted after sanitization\");\r\n    \r\n  } catch (error) {\r\n    console.error(\"[svg-utils] Error sanitizing SVG:\", error);\r\n    // Fallback: create a safe placeholder\r\n    targetEl.innerHTML = '<span>⚠️</span>';\r\n  }\r\n}\r\n\r\n/**\r\n * Apply theme colors to SVG content safely\r\n * @param {string} svgText - Original SVG text\r\n * @param {string} season - Season theme to apply\r\n * @returns {string} Themed SVG text\r\n */\r\nexport function applySVGTheming(svgText, season = 'summer') {\r\n  // Theme color mapping\r\n  const themes = {\r\n    summer: { primary: '#4ECDC4', secondary: '#45B7D1' },\r\n    autumn: { primary: '#FF6B35', secondary: '#F7931E' },\r\n    winter: { primary: '#74B9FF', secondary: '#0984E3' },\r\n    rain: { primary: '#636E72', secondary: '#2D3436' }\r\n  };\r\n  \r\n  const colors = themes[season] || themes.summer;\r\n  \r\n  // Safe string replacement - only replace known color placeholders\r\n  return svgText\r\n    .replace(/#THEME_PRIMARY/g, colors.primary)\r\n    .replace(/#THEME_SECONDARY/g, colors.secondary);\r\n}","// core-modern.js — modern ES6 entry point that enhances the existing core.js\r\nconsole.log(\"[core-modern.js] StudyFlow modern modules loading 🌀\");\r\n\r\nimport { swirlInTitle, startWindTrails, enableFrameAnimations } from \"./animation-frame.js\";\r\nimport { initializeTimerButtons, enhanceTimerDisplay } from \"./timer-module.js\";\r\nimport { loadSettings, applyThemeSettings } from \"./settings.js\";\r\nimport { safeInsertSVG, applySVGTheming } from \"./svg-utils.js\";\r\n\r\n// Wait for the legacy core.js to load first, then enhance it\r\ndocument.addEventListener(\"DOMContentLoaded\", () => {\r\n  console.log(\"[core-modern.js] DOM loaded, applying modern enhancements\");\r\n\r\n  // Give the legacy core a moment to initialize\r\n  setTimeout(() => {\r\n    initializeModernFeatures();\r\n  }, 100);\r\n});\r\n\r\nasync function initializeModernFeatures() {\r\n  try {\r\n    console.log(\"[core-modern.js] Initializing modern features\");\r\n\r\n    // Load and apply settings\r\n    const settings = loadSettings();\r\n    applyThemeSettings(settings);\r\n\r\n    // Initialize timer enhancements\r\n    initializeTimerButtons();\r\n    enhanceTimerDisplay();\r\n\r\n    // Load SVG buttons safely\r\n    await loadSafeSVGButtons(settings);\r\n\r\n    // Start intro animations\r\n    swirlInTitle();\r\n    enableFrameAnimations();\r\n    initializeTitleAnimation();\r\n\r\n    // Start wind trails after a delay (respect reduced motion)\r\n    const prefersReducedMotion = window.matchMedia('(prefers-reduced-motion: reduce)').matches;\r\n    if (!prefersReducedMotion) {\r\n      setTimeout(() => {\r\n        startWindTrails();\r\n      }, 800);\r\n    }\r\n\r\n    console.log(\"[core-modern.js] All modern features initialized ✅\");\r\n\r\n  } catch (error) {\r\n    console.error(\"[core-modern.js] Error initializing modern features:\", error);\r\n  }\r\n}\r\n\r\nfunction initializeTitleAnimation() {\r\n  const appTitle = document.getElementById('app-title');\r\n  if (!appTitle) return;\r\n\r\n  const animationStyles = ['', 'style-bounce', 'style-glow'];\r\n  let currentStyleIndex = 0;\r\n\r\n  // Cycle through animation styles every 8 seconds\r\n  setInterval(() => {\r\n    // Remove current style class\r\n    animationStyles.forEach(style => {\r\n      if (style) appTitle.classList.remove(style);\r\n    });\r\n\r\n    // Add next style class\r\n    currentStyleIndex = (currentStyleIndex + 1) % animationStyles.length;\r\n    if (animationStyles[currentStyleIndex]) {\r\n      appTitle.classList.add(animationStyles[currentStyleIndex]);\r\n    }\r\n  }, 8000);\r\n\r\n  // Add click interaction to manually cycle animations\r\n  appTitle.addEventListener('click', () => {\r\n    animationStyles.forEach(style => {\r\n      if (style) appTitle.classList.remove(style);\r\n    });\r\n    \r\n    currentStyleIndex = (currentStyleIndex + 1) % animationStyles.length;\r\n    if (animationStyles[currentStyleIndex]) {\r\n      appTitle.classList.add(animationStyles[currentStyleIndex]);\r\n    }\r\n  });\r\n\r\n  // Add hover effect for better interactivity\r\n  appTitle.style.cursor = 'pointer';\r\n  appTitle.title = 'Click to change animation style';\r\n}\r\n\r\nasync function loadSafeSVGButtons(settings) {\r\n  try {\r\n    const currentSeason = settings?.season || 'summer';\r\n    \r\n    // Load and safely insert start button\r\n    const startResponse = await fetch('assets/images/start-button.svg');\r\n    if (!startResponse.ok) throw new Error(`Failed to load start button: ${startResponse.status}`);\r\n    \r\n    const startSvg = await startResponse.text();\r\n    const startBtn = document.getElementById('btn-start');\r\n    if (startBtn) {\r\n      const themedSvg = applySVGTheming(startSvg, currentSeason);\r\n      safeInsertSVG(startBtn, themedSvg);\r\n    }\r\n    \r\n    // Load and safely insert reset button  \r\n    const resetResponse = await fetch('assets/images/reset-button.svg');\r\n    if (!resetResponse.ok) throw new Error(`Failed to load reset button: ${resetResponse.status}`);\r\n    \r\n    const resetSvg = await resetResponse.text();\r\n    const resetBtn = document.getElementById('btn-reset');\r\n    if (resetBtn) {\r\n      const themedSvg = applySVGTheming(resetSvg, currentSeason);\r\n      safeInsertSVG(resetBtn, themedSvg);\r\n    }\r\n    \r\n    console.log(\"[core-modern.js] SVG buttons safely loaded and themed\");\r\n  } catch (error) {\r\n    console.warn(\"[core-modern.js] Could not load SVG buttons:\", error);\r\n    \r\n    // Fallback: ensure text labels are visible and properly styled\r\n    const startBtn = document.getElementById('btn-start');\r\n    const resetBtn = document.getElementById('btn-reset');\r\n    \r\n    if (startBtn) {\r\n      const textSpan = startBtn.querySelector('.button-text');\r\n      if (textSpan) {\r\n        textSpan.style.display = 'block';\r\n        textSpan.style.fontSize = 'clamp(12px, 1.5vw, 16px)';\r\n      }\r\n    }\r\n    \r\n    if (resetBtn) {\r\n      const textSpan = resetBtn.querySelector('.button-text');\r\n      if (textSpan) {\r\n        textSpan.style.display = 'block';\r\n        textSpan.style.fontSize = 'clamp(12px, 1.5vw, 16px)';\r\n      }\r\n    }\r\n    \r\n    console.log(\"[core-modern.js] Using text fallback for buttons\");\r\n  }\r\n}"],"names":["swirlInTitle","title","startWindTrails","container","trail","i","enableFrameAnimations","frame","initializeTimerButtons","startBtn","resetBtn","enhanceTimerDisplay","timerUI","SETTINGS_VERSION","MAX_SETTINGS_SIZE","loadSettings","defaults","saved","parsed","validKeys","filtered","key","value","error","ALLOWED_SEASONS","clampValue","min","max","fallback","num","applyThemeSettings","settings","sanitized","bgRoot","safeInsertSVG","targetEl","svgText","doc","a","applySVGTheming","season","themes","colors","initializeModernFeatures","loadSafeSVGButtons","initializeTitleAnimation","appTitle","animationStyles","currentStyleIndex","style","currentSeason","startResponse","startSvg","themedSvg","resetResponse","resetSvg","textSpan"],"mappings":"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"}