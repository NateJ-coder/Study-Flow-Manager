<!doctype html>
<html lang="en" data-app="StudyFlow">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>StudyFlow</title>

  <!-- CSS and JS files -->
  <link rel="stylesheet" href="style.css">
  <!-- Backgrounds live under assets/images; audio under assets/audio; JSON under /data. -->
    <!-- JS will later fetch: data/studyflow_config.json -->
  </head>

  <body data-page="timer" data-theme="summer" data-daynight="day" data-timezone="Africa/Johannesburg">
    <noscript>
      <p style="padding:1rem">StudyFlow requires JavaScript to run.</p>
    </noscript>

    <!-- ===== Global Background & Effects ===== -->
    <div id="bg-root" aria-hidden="true">
      <div id="bg-slideshow" role="img" aria-label="Scenery background"></div>
      <div id="particles-layer" aria-hidden="true"></div>
      <div id="ui-tint" aria-hidden="true"></div>
    </div>

    <!-- ===== Always-on Clock + Reminders Dropdown ===== -->
    <header id="global-topbar" aria-label="Global clock and quick actions">
      <div id="clock" aria-live="polite" aria-label="Current time">
        <time id="clock-time">00:00</time>
      </div>
    </header>

    <!-- ===== Side Navigation (contextual icons; auto-hide via CSS/JS later) ===== -->
    <nav id="sidebar" aria-label="Page navigation">
      <a class="nav-item" href="calendar.html" aria-label="Open Calendar" title="Calendar" id="nav-calendar" data-target="calendar">
        <img class="nav-icon-img" src="assets/images/calendar-icon.svg" alt="Calendar" aria-hidden="true">
      </a>
      <a class="nav-item" href="settings.html" aria-label="Open Settings" title="Settings" id="nav-settings" data-target="settings">
        <img class="nav-icon-img" src="assets/images/settings-icon.svg" alt="Settings" aria-hidden="true">
      </a>
    </nav>

    <!-- ===== Rain Lockout Overlay (shown during rain) ===== -->
    <aside id="rain-lockout" role="dialog" aria-modal="true" aria-labelledby="rain-title" hidden>
      <div class="lockout-card">
        <h2 id="rain-title">It‚Äôs raining!</h2>
        <p>Don‚Äôt touch the electronics‚Äîyou will get shocked!</p>
        <p class="lockout-instruction">Use the Rain toggle in Settings to stop the rain.</p>
      </div>
    </aside>

    <!-- ===== Main App View (Timer) ===== -->
    <main id="app" aria-live="polite">

      <!-- === TIMER PAGE === -->
      <section id="page-timer" role="region" aria-label="Pomodoro Timer" data-view="timer">
        <!-- Page title - positioned top left -->
        <div id="app-title">
          StudyFlow
        </div>

        <!-- Rest Mode Timer (bottom of screen) -->
        <div id="rest-mode-timer" class="timer-mode">
          <div id="hourglass-icon">‚è≥</div>
          <div id="rest-timer-display">
            <div id="rest-session-indicator">
              session <span id="rest-session-current">2</span> of <span id="rest-session-total">4</span>
            </div>
            <div id="rest-countdown">
              <span id="rest-time-mm">05</span>:<span id="rest-time-ss">00</span>
            </div>
          </div>
        </div>

        <!-- Active Mode Timer (centered with frame) -->
        <div id="active-mode-timer" class="timer-mode active">
          <!-- Decorative Frame -->
          <div id="timer-frame-container">
            <svg id="timer-svg" viewBox="0 0 400 300" xmlns="http://www.w3.org/2000/svg">
              <!-- Decorative frame with corner elements -->
              <defs>
                <filter id="glow" x="-50%" y="-50%" width="200%" height="200%">
                  <feGaussianBlur stdDeviation="3" result="coloredBlur"/>
                  <feMerge> 
                    <feMergeNode in="coloredBlur"/>
                    <feMergeNode in="SourceGraphic"/> 
                  </feMerge>
                </filter>
              </defs>
              <!-- Main frame -->
              <rect x="20" y="20" width="360" height="260" 
                    fill="none" 
                    stroke="var(--ui-tint-primary, #dff6ff)" 
                    stroke-width="3" 
                    rx="20" 
                    opacity="0.8"
                    filter="url(#glow)"/>
              <!-- Corner decorations -->
              <circle cx="35" cy="35" r="8" fill="var(--ui-tint-primary, #dff6ff)" opacity="0.6"/>
              <circle cx="365" cy="35" r="8" fill="var(--ui-tint-primary, #dff6ff)" opacity="0.6"/>
              <circle cx="35" cy="265" r="8" fill="var(--ui-tint-primary, #dff6ff)" opacity="0.6"/>
              <circle cx="365" cy="265" r="8" fill="var(--ui-tint-primary, #dff6ff)" opacity="0.6"/>
              <!-- Center ornament -->
              <path d="M200 30 L210 40 L200 50 L190 40 Z" fill="var(--ui-tint-primary, #dff6ff)" opacity="0.5"/>
            </svg>
          </div>
          
          <!-- Timer Content (centered in frame) -->
          <div id="active-timer-content">
            <div id="active-session-indicator">
              session <span id="active-session-current">1</span> of <span id="active-session-total">4</span>
            </div>
            <div id="active-countdown">
              <span id="active-time-mm">25</span>:<span id="active-time-ss">00</span>
            </div>
          </div>
          
          <!-- SVG Buttons positioned at frame corners -->
          <div id="frame-buttons">
            <button id="btn-start" type="button" class="frame-svg-button" aria-label="Start timer">
              <!-- Start SVG will be loaded here -->
            </button>
            <button id="btn-reset" type="button" class="frame-svg-button" aria-label="Reset timer">
              <!-- Reset SVG will be loaded here -->
            </button>
          </div>
        </div>

        <!-- Set Reminder Button (bottom left) -->
        <button id="btn-set-reminder" type="button" class="text-button">
          Set Reminder
        </button>

        <!-- Season Test Button (temporary) -->
        <button id="btn-season" type="button" onclick="testSeasonSwitch()" aria-label="Test seasons" style="position: absolute; top: 60px; right: 20px; background: rgba(0,0,0,0.5); color: var(--ui-tint-primary); border: 1px solid var(--ui-tint-primary); border-radius: 4px; padding: 8px 12px; cursor: pointer; font-size: 12px; z-index: 200;">üåª</button>
      </section>

    </main>
              <input id="frame-opacity" name="frame_opacity" type="range" min="0" max="100" value="100" />
            </label>
          </fieldset>

          <!-- Season & Time -->
          <fieldset id="settings-theme">
            <legend>Theme &amp; Time</legend>

            <label>
              Season
              <select id="season" name="season">
                <option value="summer">Summer</option>
                <option value="autumn">Autumn</option>
                <option value="winter">Winter</option>
              </select>
            </label>

            <label>
              Timezone
              <select id="timezone" name="timezone">
                <!-- Options injected from JS, default Africa/Johannesburg -->
              </select>
            </label>

            <label>
              Background slideshow
              <input id="slideshow-enabled" name="slideshow_enabled" type="checkbox" checked />
            </label>

            <label>
              Slideshow interval (seconds)
              <input id="slideshow-interval" name="slideshow_interval_seconds" type="number" min="5" step="5" value="30" />
            </label>
          </fieldset>

          <!-- Pomodoro -->
          <fieldset id="settings-pomodoro">
            <legend>Pomodoro</legend>

            <label>
              Sessions
              <input id="pomodoro-sessions" name="pomodoro_sessions" type="number" min="1" value="4" />
            </label>

            <label>
              Work (minutes)
              <input id="work-minutes" name="work_minutes" type="number" min="1" value="25" />
            </label>

            <label>
              Short break (minutes)
              <input id="short-break-minutes" name="short_break_minutes" type="number" min="1" value="5" />
            </label>

            <label>
              Long break (minutes)
              <input id="long-break-minutes" name="long_break_minutes" type="number" min="1" value="20" />
            </label>

            <label>
              Short breaks before long break
              <input id="short-breaks-before-long" name="short_breaks_before_long" type="number" min="1" value="3" />
            </label>
          </fieldset>

          <!-- Weather & Rain -->
          <fieldset id="settings-weather">
            <legend>Weather &amp; Rain</legend>

            <button id="rain-toggle" type="button">Start Rain</button>
          </fieldset>

          <menu>
            <button id="settings-save" type="submit">Save</button>
            <button id="settings-cancel" type="reset">Reset</button>
          </menu>
        </form>
      </section>
    </main>

    <!-- ===== Audio (preloaded, controlled later by JS) ===== -->
  <audio id="audio-rain" src="assets/audio/rainfall.mp3" preload="auto" loop></audio>
  <audio id="audio-splash" src="assets/audio/splash.mp3" preload="auto"></audio>
  <audio id="audio-drawing" src="assets/audio/drawing.mp3" preload="auto"></audio>
  <audio id="audio-click" src="assets/audio/click.mp3" preload="auto"></audio>

    <!-- ===== Data sources (fetched later by JS) ===== -->
    <!-- studyflow_config.json will be fetched from: /data/studyflow_config.json -->

    <!-- Firebase init will be added later in JS using your provided config -->
    <script src="core.js"></script>
  </body>
</html>
